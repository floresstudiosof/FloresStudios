<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Descargar TikTok</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body{
  background:linear-gradient(180deg,#d1fae5,#ecfeff);
}
.loader{
  border:6px solid #fff;
  border-top:6px solid #10b981;
  border-radius:50%;
  width:45px;
  height:45px;
  animation:spin .9s linear infinite;
  margin:auto;
}
@keyframes spin{to{transform:rotate(360deg)}}
.btn-main{
  background:linear-gradient(45deg,#10b981,#06b6d4);
  color:#fff;
}
</style>
</head>

<body class="text-gray-800">

<div class="max-w-xl mx-auto p-6 mt-8 bg-white rounded-2xl shadow-xl border border-emerald-300">

  <h2 class="text-3xl font-bold text-center text-emerald-600 mb-4">
    Descargar TikTok
  </h2>

  <p class="text-center text-gray-600 mb-6">
    Video · Imagen · Alta calidad
  </p>

  <input id="videoURL"
    class="w-full p-3 border-2 border-emerald-400 rounded-xl"
    placeholder="Pega aquí el enlace de TikTok">

  <button onclick="processTikTok()"
    class="w-full mt-4 p-3 rounded-xl font-semibold btn-main">
    Descargar
  </button>

  <div id="loading" class="hidden mt-4">
    <div class="loader"></div>
  </div>

  <!-- PREVIEW -->
  <div id="previewContainer" class="hidden mt-6">

    <!-- VIDEO -->
    <video id="previewVideo" controls class="w-full rounded-xl hidden"></video>

    <!-- IMAGEN -->
    <img id="previewImage" class="w-full rounded-xl hidden" alt="Imagen TikTok">

    <!-- BOTONES -->
    <div class="grid gap-3 mt-4">
      <a id="downloadHD" target="_blank"
         class="hidden bg-emerald-500 text-white p-3 rounded-xl text-center">
        Descargar Video HD
      </a>

      <a id="download4K" target="_blank"
         class="hidden bg-emerald-600 text-white p-3 rounded-xl text-center">
        Descargar Video 4K
      </a>

      <a id="downloadMP3" target="_blank"
         class="hidden bg-emerald-700 text-white p-3 rounded-xl text-center">
        Descargar MP3
      </a>

      <a id="downloadIMG" target="_blank" download
         class="hidden bg-cyan-600 text-white p-3 rounded-xl text-center">
        Descargar Imagen (Alta calidad)
      </a>
    </div>
  </div>
</div>

<footer class="max-w-xl mx-auto mt-6 mb-10 p-4 bg-white rounded-2xl shadow text-center text-xs text-gray-500">
© 2026 FLORES Studios. Todos los derechos reservados.
</footer>

<script>
async function processTikTok(){
  const url = document.getElementById('videoURL').value.trim();
  const loading = document.getElementById('loading');
  const previewContainer = document.getElementById('previewContainer');

  const previewVideo = document.getElementById('previewVideo');
  const previewImage = document.getElementById('previewImage');

  const downloadHD = document.getElementById('downloadHD');
  const download4K = document.getElementById('download4K');
  const downloadMP3 = document.getElementById('downloadMP3');
  const downloadIMG = document.getElementById('downloadIMG');

  if(!url || !url.includes('tiktok.com')){
    alert('Pega un enlace válido de TikTok');
    return;
  }

  // Reset
  previewContainer.classList.add('hidden');
  previewVideo.classList.add('hidden');
  previewImage.classList.add('hidden');
  downloadHD.classList.add('hidden');
  download4K.classList.add('hidden');
  downloadMP3.classList.add('hidden');
  downloadIMG.classList.add('hidden');

  loading.classList.remove('hidden');

  try{
    const r = await fetch('https://www.tikwm.com/api/',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ url:url, hd:1 })
    });

    const j = await r.json();
    if(j.code !== 0 || !j.data) throw 'error';

    /* ===== VIDEO ===== */
    if(j.data.play){
      previewVideo.src = j.data.play;
      previewVideo.classList.remove('hidden');

      downloadHD.href = j.data.play;
      download4K.href = j.data.hdplay || j.data.play;
      downloadMP3.href = j.data.music || '#';

      downloadHD.classList.remove('hidden');
      download4K.classList.remove('hidden');
      downloadMP3.classList.remove('hidden');
    }

    /* ===== IMAGEN ===== */
    let imageUrl = null;

    if(Array.isArray(j.data.images) && j.data.images.length){
      imageUrl = j.data.images[0];
    }else if(
      j.data.image_post_info &&
      Array.isArray(j.data.image_post_info.images) &&
      j.data.image_post_info.images.length &&
      j.data.image_post_info.images[0].display_image &&
      Array.isArray(j.data.image_post_info.images[0].display_image.url_list)
    ){
      imageUrl = j.data.image_post_info.images[0].display_image.url_list[0];
    }

    if(imageUrl){
      previewImage.src = imageUrl;
      previewImage.classList.remove('hidden');
      downloadIMG.href = imageUrl;
      downloadIMG.classList.remove('hidden');
    }

    previewContainer.classList.remove('hidden');

  }catch(e){
    alert('No se pudo procesar el enlace');
  }

  loading.classList.add('hidden');
}
</script>

</body>
</html>