<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Descargar TikTok</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
/* ===== FONDO CON IMAGEN ===== */
body{
  min-height:100vh;
  background-image:url("https://www.dropbox.com/scl/fi/eu9gnmhb6a9sowhixnxtc/1769700352946.jpg?rlkey=6wnx8lf9e4wqi5y5ewusyt3o2&dl=1");
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  background-attachment:fixed;
}

/* Overlay suave (NO bloquea clics) */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.25);
  z-index:-1;
  pointer-events:none;
}

/* ===== UI ===== */
.loader{
  border:6px solid #ffffff;
  border-top:6px solid #10b981;
  border-radius:50%;
  width:42px;
  height:42px;
  animation:spin .9s linear infinite;
  margin:auto;
}
@keyframes spin{to{transform:rotate(360deg)}}

.btn-main{
  background:linear-gradient(45deg,#10b981,#06b6d4);
  color:#ffffff;
}

/* Evita zoom raro en iOS */
input, button{
  font-size:16px;
}
</style>
</head>

<body class="text-white">

<!-- ================= CONTENIDO ================= -->
<div class="max-w-xl mx-auto p-6 mt-8 relative z-10 bg-black/30 backdrop-blur rounded-2xl">

  <h2 class="text-3xl font-bold text-center text-emerald-300 mb-4 drop-shadow-lg">
    Descargar TikTok
  </h2>

  <p class="text-center text-emerald-100 mb-6 drop-shadow">
    Video · Imagen · Alta calidad
  </p>

  <input id="videoURL"
    class="w-full p-3 border-2 border-emerald-300 rounded-xl bg-black/40 text-white placeholder-gray-200"
    placeholder="Pega aquí el enlace de TikTok">

  <button onclick="processTikTok()"
    class="w-full mt-4 p-3 rounded-xl font-semibold btn-main">
    Descargar
  </button>

  <div id="loading" class="hidden mt-4">
    <div class="loader"></div>
  </div>

  <div id="previewContainer" class="hidden mt-6">

    <video id="previewVideo" controls playsinline class="w-full rounded-xl hidden"></video>
    <img id="previewImage" class="w-full rounded-xl hidden" alt="Imagen TikTok">

    <div class="grid gap-3 mt-4">
      <a id="downloadHD" target="_blank"
         class="hidden bg-emerald-500 text-white p-3 rounded-xl text-center">
        Descargar Video HD
      </a>
      <a id="download4K" target="_blank"
         class="hidden bg-emerald-600 text-white p-3 rounded-xl text-center">
        Descargar Video 4K
      </a>
      <a id="downloadMP3" target="_blank"
         class="hidden bg-emerald-700 text-white p-3 rounded-xl text-center">
        Descargar MP3
      </a>
      <a id="downloadIMG" target="_blank" download
         class="hidden bg-cyan-600 text-white p-3 rounded-xl text-center">
        Descargar Imagen
      </a>
    </div>
  </div>
</div>

<!-- ================= FOOTER ================= -->
<footer class="max-w-xl mx-auto mt-6 mb-10 p-4 text-center text-xs text-gray-200 relative z-10">
© 2026 FLORES Studios. Todos los derechos reservados.
</footer>

<!-- ================= SCRIPT ================= -->
<script>
async function processTikTok(){
  const url = document.getElementById('videoURL').value.trim();
  const loading = document.getElementById('loading');
  const previewContainer = document.getElementById('previewContainer');
  const previewVideo = document.getElementById('previewVideo');
  const previewImage = document.getElementById('previewImage');
  const downloadHD = document.getElementById('downloadHD');
  const download4K = document.getElementById('download4K');
  const downloadMP3 = document.getElementById('downloadMP3');
  const downloadIMG = document.getElementById('downloadIMG');

  if(!url || !url.includes('tiktok.com')){
    alert('Pega un enlace válido de TikTok');
    return;
  }

  previewContainer.classList.add('hidden');
  previewVideo.classList.add('hidden');
  previewImage.classList.add('hidden');
  downloadHD.classList.add('hidden');
  download4K.classList.add('hidden');
  downloadMP3.classList.add('hidden');
  downloadIMG.classList.add('hidden');
  loading.classList.remove('hidden');

  try{
    const apiURL = `https://www.tikwm.com/api/?url=${encodeURIComponent(url)}&hd=1`;
    const res = await fetch(apiURL);
    const json = await res.json();
    if(json.code !== 0 || !json.data) throw new Error();

    const d = json.data;

    if(d.play){
      previewVideo.src = d.play;
      previewVideo.classList.remove('hidden');
      downloadHD.href = d.play;
      download4K.href = d.hdplay || d.play;
      downloadMP3.href = d.music || '#';
      downloadHD.classList.remove('hidden');
      download4K.classList.remove('hidden');
      downloadMP3.classList.remove('hidden');
    }

    let img = d.images?.[0] ||
              d.image_post_info?.images?.[0]?.display_image?.url_list?.[0];

    if(img){
      previewImage.src = img;
      previewImage.classList.remove('hidden');
      downloadIMG.href = img;
      downloadIMG.classList.remove('hidden');
    }

    previewContainer.classList.remove('hidden');

  }catch(e){
    alert('No se pudo procesar el enlace');
  }

  loading.classList.add('hidden');
}
</script>

</body>
</html>