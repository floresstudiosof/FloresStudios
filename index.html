<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Descargar TikTok Alta Calidad</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body{
  background:linear-gradient(180deg,#d1fae5,#ecfeff);
}

/* Loader */
.loader{
  border:6px solid #ffffff;
  border-top:6px solid #10b981;
  border-radius:50%;
  width:45px;
  height:45px;
  animation:spin .9s linear infinite;
  margin:auto;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* Botón */
.btn-main{
  background:linear-gradient(45deg,#10b981,#06b6d4);
  color:#ffffff;
}
</style>
</head>

<body class="text-gray-800">

<div class="max-w-xl mx-auto p-6 mt-8 bg-white rounded-2xl shadow-xl border border-emerald-300">

  <h1 class="text-3xl font-bold text-center text-emerald-600 mb-4">
    Descargar TikTok
  </h1>

  <p class="text-center text-gray-600 mb-6">
    Video · Foto · Alta calidad · MP3
  </p>

  <input
    id="videoURL"
    type="text"
    class="w-full p-3 border-2 border-emerald-400 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-300"
    placeholder="Pega aquí el enlace de TikTok"
  >

  <button
    onclick="processVideo()"
    class="w-full mt-4 p-3 rounded-xl font-semibold btn-main">
    Descargar
  </button>

  <div id="loading" class="hidden mt-4">
    <div class="loader"></div>
  </div>

  <!-- Preview -->
  <div id="previewContainer" class="hidden mt-6">

    <!-- Video -->
    <video id="previewVideo" controls class="w-full rounded-xl hidden"></video>

    <!-- Imagen -->
    <img id="previewImage" class="w-full rounded-xl hidden" alt="Preview imagen TikTok">

    <div class="grid gap-3 mt-4">
      <a id="downloadHD" target="_blank"
         class="hidden bg-emerald-500 text-white p-3 rounded-xl text-center">
        Descargar Video HD
      </a>

      <a id="download4K" target="_blank"
         class="hidden bg-emerald-600 text-white p-3 rounded-xl text-center">
        Descargar Video 4K
      </a>

      <a id="downloadMP3" target="_blank"
         class="hidden bg-emerald-700 text-white p-3 rounded-xl text-center">
        Descargar MP3
      </a>

      <a id="downloadIMG" target="_blank" download
         class="hidden bg-cyan-600 text-white p-3 rounded-xl text-center">
        Descargar Imagen (Alta calidad)
      </a>
    </div>
  </div>
</div>

<footer class="max-w-xl mx-auto mt-6 mb-10 p-4 bg-white rounded-2xl shadow text-center text-xs text-gray-500">
© 2026 FLORES Studios. Todos los derechos reservados.
</footer>

<script>
async function processVideo(){
  const url = document.getElementById('videoURL').value.trim();
  const loading = document.getElementById('loading');
  const previewContainer = document.getElementById('previewContainer');

  const previewVideo = document.getElementById('previewVideo');
  const previewImage = document.getElementById('previewImage');

  const downloadHD = document.getElementById('downloadHD');
  const download4K = document.getElementById('download4K');
  const downloadMP3 = document.getElementById('downloadMP3');
  const downloadIMG = document.getElementById('downloadIMG');

  if(!url || !url.includes('tiktok.com')){
    alert('Pega un enlace válido de TikTok');
    return;
  }

  loading.classList.remove('hidden');
  previewContainer.classList.add('hidden');

  // Reset
  previewVideo.classList.add('hidden');
  previewImage.classList.add('hidden');
  downloadHD.classList.add('hidden');
  download4K.classList.add('hidden');
  downloadMP3.classList.add('hidden');
  downloadIMG.classList.add('hidden');

  try{
    const response = await fetch('https://www.tikwm.com/api/',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({ url:url, hd:1 })
    });

    const data = await response.json();
    if(data.code !== 0) throw new Error();

    /* VIDEO */
    if(data.data.play){
      previewVideo.src = data.data.play;
      previewVideo.classList.remove('hidden');

      downloadHD.href = data.data.play;
      download4K.href = data.data.hdplay || data.data.play;
      downloadMP3.href = data.data.music || '#';

      downloadHD.classList.remove('hidden');
      download4K.classList.remove('hidden');
      downloadMP3.classList.remove('hidden');
    }

    /* FOTO (ALTA CALIDAD ORIGINAL) */
    if(data.data.images && data.data.images.length > 0){
      const imgHQ = data.data.images[0]; // máxima calidad disponible
      previewImage.src = imgHQ;
      previewImage.classList.remove('hidden');

      downloadIMG.href = imgHQ;
      downloadIMG.classList.remove('hidden');
    }

    previewContainer.classList.remove('hidden');

  }catch(e){
    alert('No se pudo procesar el contenido');
  }

  loading.classList.add('hidden');
}
</script>

</body>
</html>